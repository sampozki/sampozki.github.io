<html>
	<head>

		<meta name="author" content="Sampo Pelto">
		<meta name="description" content="BPM measuring app">
		<meta name="keywords" content="BPM, beats per minute">
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
		<meta name="theme-color" content="#EEEEEE">

		<title>BPM</title>

		<link href="https://fonts.googleapis.com/css?family=Nova+Mono" rel="stylesheet">
		<link rel="stylesheet" type="text/css" href="style.css">

		<script>

		const bgcolor = ["#ED7979", "#9D9D9D", "#67ADE2", "#EFEFEF", "#86DF6D"];
		const sccolor = ["#A74442", "#222222", "#455682", "#888888", "#4B853F"];
		//red black blue white green

		let index = Math.floor(Math.random() * bgcolor.length);

		document.getElementsByTagName('meta')["theme-color"].content = bgcolor[index];
		document.documentElement.style.setProperty("--bgcolor", bgcolor[index]);
		document.documentElement.style.setProperty("--sccolor", sccolor[index]);

		</script>

	</head>
	<body>

		<div class="content">
			<h2 id="tap">tap</h2>
			<span id="reset">reset</span>
			<hr>
			<input onclick="reset()" type="button" id="resetbutton"/>
			<input onclick="tap()" type="button" id="tapbutton"/>
		</div>

			<script>

			let count = 0;
			let startTime;
			let bpm;

			function tap() {
			  if (count == 0) {
					startTime = Date.now();
			  }

				count++;
				bpm = 1/(((Date.now()-startTime)/60000)/(count-1));
				if (count > 1) {
					document.getElementById("tap").innerHTML = (Math.round(bpm)).toString();
					document.getElementById("tap").style.animationDuration = (1/bpm*60).toString()+'s';
				}
			}

			function reset(){
			  count = 0;
			  document.getElementById("tap").innerHTML = "tap";
				document.getElementById("tap").style.animationDuration = '0s';
			}

			</script>

	</body>
</html>
